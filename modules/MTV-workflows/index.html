<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="google-site-verification" content="RUElhd5171Z1GQ5VA3nhWfpeXj4CnaYhbb4bRj1E75w" />
    <meta name="yandex-verification" content="650ce1b8e197bbb8" />
    <meta charset="UTF-8">
    <script src="//use.fontawesome.com/releases/v5.1.0/js/all.js" integrity="sha384-3LK/3kTpDE/Pkp8gTNp2gR/2gOiwQ6QaO7Td0zV76UFJVhqLl4Vl3KL1We6q6wR9" crossorigin="anonymous"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Forklift documentation</title>
    <!-- # Opengraph protocol properties: https://ogp.me/ -->
    <meta name="author" content="Red Hat Modernization and Migration Solutions documentation team" >
    <meta property="og:type" content="article" >
    <meta name="twitter:card" content="summary">
    <meta name="keywords" content="" >
    <meta property="og:type" content="website">
    <meta property="og:image" content="">
    <meta property="og:article:author" content="Red Hat Modernization and Migration Solutions documentation team" >
    <meta property="og:article:published_time" content="2021-01-26 18:13:30 -0600" >
    <meta name="twitter:title" content="Forklift documentation">
    <meta name="twitter:description" content="Forklift documentation">


<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Forklift documentation | Forklift documentation</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Forklift documentation" />
<meta name="author" content="Red Hat Modernization and Migration Solutions documentation team" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Forklift documentation" />
<meta property="og:description" content="Forklift documentation" />
<meta property="og:site_name" content="Forklift documentation" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Red Hat Modernization and Migration Solutions documentation team"},"url":"/forklift-documentation/modules/MTV-workflows/","description":"Forklift documentation","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/forklift-documentation/assets/img/forklift-logo-lightbg.svg"},"name":"Red Hat Modernization and Migration Solutions documentation team"},"headline":"Forklift documentation","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/forklift-documentation/assets/css/style.css?v=773261377575a944d0dc092c87dc4c2f54dfad35">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        
          <img src="/forklift-documentation/assets/img/forklift-logo-lightbg.svg" alt="Logo" width="200" />
        

        <h1><a href="/forklift-documentation/">Forklift documentation</a></h1>

        <!-- <p>Forklift documentation</p> -->

        
        <p class="view"><a href="https://github.com/konveyor/forklift-documentation">View the Project on GitHub <small>konveyor/forklift-documentation</small></a></p>
        

        

        
      </header>
      <section>

      <h1 id="mtv-workflows_forklift">Forklift workflows</h1>
<div class="paragraph">
<p>This section describes the Forklift and KubeVirt workflows for migrating virtual machines (VMs). These steps assume that you are performing the migration using the Forklift console but you can also perform these steps using the CLI.</p>
</div>
<div class="paragraph">
<p>The power state of a source VM is maintained after migration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These diagrams are in progress.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../modules/images/mtv-workflow.png" alt="Forklift workflow" width="800">
</div>
<div class="title">Figure 1. Forklift workflow</div>
</div>
<div class="paragraph">
<p>The Forklift workflow comprises the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You create a source provider, a target provider, a network mapping, and a storage mapping.</p>
</li>
<li>
<p>You create a migration plan that includes the following resources:</p>
<div class="ulist">
<ul>
<li>
<p>Source provider</p>
</li>
<li>
<p>Target provider</p>
</li>
<li>
<p>Network mapping</p>
</li>
<li>
<p>Storage mapping</p>
</li>
<li>
<p>One or more VMs</p>
</li>
</ul>
</div>
</li>
<li>
<p>You run a migration plan. Each time you run a migration plan, the plan creates a <code>Migration</code> CR. If a migration is incomplete, you can run a migration plan multiple times until all VMs are migrated.</p>
</li>
<li>
<p>For each VM in the migration plan, the <em>Migration Controller</em> creates a <code>VirtualMachineImport</code> CR and monitors its status. When all VMs have been migrated, the Migration Controller sets the status of the migration plan to <code>Completed</code>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../modules/images/ocp-virt-workflow.png" alt="KubeVirt workflow" width="800">
</div>
<div class="title">Figure 2. KubeVirt workflow</div>
</div>
<div class="paragraph">
<p>The KubeVirt workflow comprises the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When you run a migration plan, the <em>Migration Controller</em> creates a <code>VirtualMachineImport</code> CR for each source VM.</p>
</li>
<li>
<p>The <em>Virtual Machine Import Controller</em> validates the <code>VirtualMachineImport</code> CR and generates a <code>VirtualMachine</code> CR and a <code>VirtualMachineInstance</code> CR.</p>
</li>
<li>
<p>The Virtual Machine Import Controller retrieves the VM configuration, including network, storage, and metadata, linked in the <code>VirtualMachineImport</code> CR.  </p>
<div class="paragraph">
<p><em>For each VM disk:</em></p>
</div>
</li>
<li>
<p>The Virtual Machine Import Controller creates a <code>DataVolume</code> CR as a wrapper for the Persistent Volume Claim (PVC) and annotations.  </p>
</li>
<li>
<p>The <em>Containerized Data Importer (CDI) Controller</em> creates a PVC. The Persistent Volume (PV) is dynamically provisioned by the <code>StorageClass</code> provisioner.  </p>
</li>
<li>
<p>The CDI Controller creates an <code>Importer</code> pod. The <code>Importer</code> pod connects to the source VM disk, by using the VDDK SDK, and streams the disk to the PV.</p>
</li>
<li>
<p>After the VM disks are transferred, the Virtual Machine Import Controller creates a <code>Conversion</code> pod that runs <code>virt-v2v</code> with all the PVCs attached to it.</p>
</li>
<li>
<p>When the VM is powered on, the KubeVirt Controller creates a <code>VirtualMachineInstance</code> that runs the <code>QEMU-KVM</code> process with the PVCs attached as VM disks.</p>
</li>
</ol>
</div>

      </section>
      <footer>
        
        <p>This project is maintained by <a href="https://github.com/konveyor">konveyor</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/forklift-documentation/assets/js/scale.fix.js"></script>
    
  </body>
</html>
